/**
 * OS.js - JavaScript Cloud/Web Desktop Platform
 *
 * Copyright (c) 2011-2017, Anders Evenrud <andersevenrud@gmail.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * @author  Anders Evenrud <andersevenrud@gmail.com>
 * @licence Simplified BSD License
 * @preserve
 */
!function(t){function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var e={};i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},i.p="",i(i.s=0)}([function(t,i,e){e(1),t.exports=e(3)},function(t,i,e){"use strict";function o(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function n(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function r(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}var a=function(){function t(t,i){for(var e=0;e<i.length;e++){var o=i[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(i,e,o){return e&&t(i.prototype,e),o&&t(i,o),i}}(),u=function t(i,e,o){null===i&&(i=Function.prototype);var n=Object.getOwnPropertyDescriptor(i,e);if(void 0===n){var r=Object.getPrototypeOf(i);return null===r?void 0:t(r,e,o)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(o)},s=OSjs.require("utils/dom"),l=OSjs.require("utils/events"),c=OSjs.require("core/dialog"),h=OSjs.require("core/locales"),f=OSjs.require("core/connection"),p=OSjs.require("vfs/file"),d=OSjs.require("helpers/default-application"),g=OSjs.require("helpers/default-application-window"),m=function(t){function i(t,e,r){o(this,i);var a=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,"ApplicationPreviewWindow",{allow_drop:!0,icon:e.icon,title:e.name,width:400,height:200},t,r));return a.zoomLevel=0,a.isImage=!0,a.origWidth=0,a.origHeight=0,a.$view=null,a}return r(i,t),a(i,[{key:"destroy",value:function(){return this.$view=null,u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"destroy",this).apply(this,arguments)}},{key:"init",value:function(t,o){var n=this,r=u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"init",this).apply(this,arguments);this._render("PreviewWindow",e(2)),this._find("ZoomIn").son("click",this,this.onZoomIn),this._find("ZoomOut").son("click",this,this.onZoomOut),this._find("ZoomFit").son("click",this,this.onZoomFit),this._find("ZoomOriginal").son("click",this,this.onZoomOriginal),this._find("SubmenuFile").on("select",function(t){"MenuOpenLocation"===t.detail.id&&c.create("Input",{value:"http://"},function(t,i,e){if("ok"===i){if(!e.match(/^http/))return void n._setWarning(h._("ERR_OPEN_LOCATION_FMT",h._("ERR_INVALID_LOCATION")));f.request("curl",{method:"HEAD",url:e},function(t,i){var o=i.headers["content-type"];o||(t=h._("ERR_VFS_NO_MIME_DETECT")),t?n._setWarning(h._("ERR_OPEN_LOCATION_FMT",t)):n.showFile(new p(e,o),e)})}},{parent:n,modal:!0})});var a=this._find("Content").$element;return l.$bind(a,"mousewheel",function(t,i){1===i.z?n.onZoomOut():-1===i.z&&n.onZoomIn()}),r}},{key:"showFile",value:function(t,e){var o=this,n=this._find("Content").$element;s.$empty(n),e&&(this.zoomLevel=0,t.mime.match(/^image/)?(this.isImage=!0,this.$view=this._create("gui-image",{src:e},n,{onload:function(){o.origWidth=this.offsetWidth,o.origHeight=this.offsetHeight,o._resizeTo(this.offsetWidth,this.offsetHeight,!0,!1,this)}})):t.mime.match(/^video/)&&(this.isImage=!1,this.$view=this._create("gui-video",{src:e,controls:!0,autoplay:!0},n,{onload:function(){o._resizeTo(this.offsetWidth,this.offsetHeight,!0,!1,this)}})));var r=this._find("Toolbar");r&&r[this.isImage?"show":"hide"](),u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"showFile",this).apply(this,arguments)}},{key:"_onZoom",value:function(t){if(this.isImage&&this.$view){var i=-1!==["in","out"].indexOf(t),e="zoomed",o=null;if("in"===t?this.zoomLevel=Math.min(10,this.zoomLevel+1):"out"===t?this.zoomLevel=Math.max(-10,this.zoomLevel-1):(this.zoomLevel=0,e="fit"===t?t:""),i){var n=this.zoomLevel;0===n?(n=1,o=this.origWidth):n>0?(n+=1,o=this.origWidth*n):n<0&&(n-=1,o=Math.abs(this.origWidth/n)),this._setTitle(this.currentFile.filename+" ("+String(100*n)+"%)",!0)}else this._setTitle(this.currentFile.filename,!0);this.$view.$element.setAttribute("data-zoom",e),this.$view.$element.firstChild.style.width=null===o?"auto":String(o)+"px"}}},{key:"onZoomIn",value:function(){this._onZoom("in")}},{key:"onZoomOut",value:function(){this._onZoom("out")}},{key:"onZoomFit",value:function(){this._onZoom("fit")}},{key:"onZoomOriginal",value:function(){this._onZoom()}}]),i}(g),_=function(t){function i(t,e){return o(this,i),n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,"ApplicationPreview",t,e,{readData:!1}))}return r(i,t),a(i,[{key:"init",value:function(t,e){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"init",this).apply(this,arguments);var o=this._getArgument("file");this._addWindow(new m(this,e,o))}}]),i}(d);OSjs.Applications.ApplicationPreview=_},function(t,i){t.exports='<application-window data-id="PreviewWindow"> <gui-vbox> \x3c!-- MENU BAR --\x3e <gui-vbox-container data-grow="0" data-shrink="1" data-basis="auto"> <gui-menu-bar> <gui-menu-bar-entry data-label="LBL_FILE"> <gui-menu data-id="SubmenuFile"> <gui-menu-entry data-id="MenuOpen" data-label="LBL_OPEN"></gui-menu-entry> <gui-menu-entry data-id="MenuOpenLocation" data-label="LBL_OPEN_LOCATION"></gui-menu-entry> <gui-menu-entry data-id="MenuClose" data-label="LBL_CLOSE"></gui-menu-entry> </gui-menu> </gui-menu-bar-entry> </gui-menu-bar> </gui-vbox-container> \x3c!-- TOOLBAR --\x3e <gui-vbox-container data-grow="0" data-shrink="1" data-basis="auto" data-id="Toolbar"> <gui-toolbar> <gui-button data-id="ZoomOriginal" data-stock-icon="16x16/actions/zoom-original.png"></gui-button> <gui-button data-id="ZoomFit" data-stock-icon="16x16/actions/zoom-fit-best.png"></gui-button> <gui-button data-id="ZoomOut" data-stock-icon="16x16/actions/zoom-out.png"></gui-button> <gui-button data-id="ZoomIn" data-stock-icon="16x16/actions/zoom-in.png"></gui-button> </gui-toolbar> </gui-vbox-container> \x3c!-- CONTENT --\x3e <gui-vbox-container data-grow="1" data-shrink="0" data-basis="auto" data-fill="true"> <gui-container data-id="Content"> </gui-container> </gui-vbox-container> </gui-vbox></application-window>'},function(t,i){}]);
//# sourceMappingURL=main.js.map